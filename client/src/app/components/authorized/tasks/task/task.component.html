<app-go-back-button></app-go-back-button>
<mat-tab-group class="tab-group" mat-align-tabs="center">
  <mat-tab label="Task details">
    <ng-template matTabContent>
      <div *ngIf="task | async as task else loader" class="task-details-container">
        <div class="task-details-header">
          <button class="start-button" mat-raised-button>
            <i class="fas fa-play"></i>
            <span class="button-label">Start task</span>
          </button>
          <div>
            <div [matTooltip]="deadlineTooltip" class="deadline-container" matTooltipClass="tooltip">
              <i class="fas fa-hourglass-end deadline-icon"></i>
              <p class="button-label deadline">{{task.deadline | date}}</p>
            </div>
          </div>
          <div class="task-details-header-right">
            <div class="task-progress-bar">
              <div [ngClass]="{'task-new': task.state === taskState.NEW}" class="task-progress-state">
                <p class="task-progress-state-label">New</p>
              </div>
              <div [ngClass]="{'task-in-progress': task.state === taskState.IN_PROGRESS}" class="task-progress-state">
                <p class="task-progress-state-label">In progress</p>
              </div>
              <div [ngClass]="{'task-finished': task.state === taskState.FINISHED}" class="task-progress-state">
                <p class="task-progress-state-label">Finished</p>
              </div>
            </div>
            <app-copy-to-clipboard [contentToCopy]="task.description" [copyTooltipMessage]="copyTooltip">
              <i class="fab fa-markdown md-icon"></i>
            </app-copy-to-clipboard>
            <div class="download-task-container">
              <button (click)="downloadTaskAsPdf(task.id)" [matTooltip]="downloadTaskTooltip"
                      class="download-task-button"
                      matTooltipClass="tooltip">
                <i class="fas fa-file-download"></i>
              </button>
            </div>
          </div>
        </div>
        <div class="task-preview md-preview">
          <div [innerHTML]="markdownToHtml(task.title)" class="task-title"></div>
          <div [innerHTML]="markdownToHtml(task.description)"></div>
        </div>

        <div #taskPreview class="print-container hide-print-container">
          <p class="print-app-name">Readytask</p>
          <div class="print-content-header">
            <div>
              <p><span>Task reference: </span>{{task.id}}</p>
              <p><span>Team: </span>{{task.team.name}}</p>
              <p><span>Assigned by: </span>{{task.authorOfTask.firstName}} {{task.authorOfTask.lastName}}</p>
              <p><span>Assigned to: </span>{{task.userAssignedToTask.firstName}} {{task.userAssignedToTask.lastName}}
              </p>
            </div>
            <div>
              <p><span>Task created at: </span>{{task.createdAt | date: 'dd.MM.yyyy'}}</p>
              <p><span>Deadline: </span>{{task.deadline | date: 'dd.MM.yyyy'}}</p>
            </div>
          </div>
          <div class="md-print">
            <div [innerHTML]="markdownToHtml(task.title)" class="task-title"></div>
            <div [innerHTML]="markdownToHtml(task.description)" class="md-print"></div>
          </div>
        </div>
      </div>
    </ng-template>
  </mat-tab>
  <mat-tab label="Task forum">
  </mat-tab>
</mat-tab-group>

<ng-template #loader>
  <div class="loader">
    <mat-spinner></mat-spinner>
  </div>
</ng-template>
