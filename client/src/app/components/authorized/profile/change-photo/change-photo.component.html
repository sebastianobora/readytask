<div class="container container-size">
  <p class="header">Change photo</p>
  <p class="description">Maximum photo size is {{maxImageSizeInMb}}MB</p>
  <div class="separator"></div>
  <div *ngIf="currentDisplayedImage else placeholder" class="image-container">
    <div class="delete-container">
      <i class="fas fa-trash delete"></i>
    </div>
    <img (load)="freeMemory()" [src]="currentDisplayedImage" alt="User photo"/>
  </div>
  <ng-template #placeholder>
    <app-placeholder [text]="user?.firstName" shadow="dark" shape="rounded" size="x-large"></app-placeholder>
  </ng-template>
  <mat-error>
    <p class="photo-error">{{invalidImageError}}</p>
  </mat-error>
  <form class="form">
    <input #inputPhoto (change)="setImage($event)" accept=".png, .jpg, .jpeg"
           class="input-photo" type="file">
    <button (click)="inputPhoto.click()" mat-raised-button>
      Browse files
      <i class="far fa-file-image"></i>
    </button>
    <button (click)="validAndSaveImage()"
            [disabled]="!uploadedImage.value || !!invalidImageError"
            [matTooltipDisabled]="!!uploadedImage.value && !invalidImageError"
            [matTooltip]="changeImageDisabledHint"
            mat-raised-button>
      Save
      <i class="fas fa-file-upload"></i>
    </button>
    <ng-container *ngIf="uploadPercent | async as uploadPercent">
      <mat-progress-bar [value]="uploadPercent" class="progress-bar" mode="determinate"></mat-progress-bar>
    </ng-container>
  </form>
</div>
